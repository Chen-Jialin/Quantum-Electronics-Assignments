% !Tex program = pdflatex
% 第 6 章: 光束在均匀介质和类透镜介质中的传播
\ifx\allfiles\undefined
\documentclass[twoside]{note}
\begin{document}
\fi
\setcounter{chapter}{5}
\chapter{光束在均匀介质和类透镜介质中的传播}
\begin{exe}
    推导 (6.2-1) 至 (6.2-4) 各式.
\end{exe}
\begin{pf}
    对相同透镜构成的波导, (在 $n+1$ 处) 出射和 (在 $n$ 处) 出射光线之间的关系为
    \begin{align}
        \begin{bmatrix}
            r_{n+1}\\
            r_{n+1}'
        \end{bmatrix}=\begin{bmatrix}
            1&d\\
            -1/f&(1-d/f)
        \end{bmatrix}\begin{bmatrix}
            r_n\\
            r_n'
        \end{bmatrix},
    \end{align}
    或将其写成方程形式为
    \begin{align}
        \label{6.1-1}
        r_{n+1}=&r_n+dr_n',\\
        \label{6.1-2}
        r_{n+1}'=&-\frac{1}{f}r_n+\left(1-\frac{d}{f}\right)r_n'.
    \end{align}
    由式 \eqref{6.1-1} 得
    \begin{align}
        r_n'=\frac{1}{d}(r_{n+1}-r_n),
    \end{align}
    因而有
    \begin{align}
        r_{n+1}'=\frac{1}{d}(r_{n+2}-r_{n+1}),
    \end{align}
    将以上两式代入式 \eqref{6.1-2} 中得
    \begin{align}
        \label{6.1-3}
        r_{n+2}-\left(2-\frac{d}{f}\right)r_{n+1}+r_n=0.
    \end{align}
    上式为微分方程
    \begin{align}
        r''+\frac{d}{f}r=0
    \end{align}
    的差分方程, 故令试探解为
    \begin{align}
        r_n=r_0e^{in\theta},
    \end{align}
    将其代入式 \eqref{6.1-3} 中可得
    \begin{align}
        e^{2i\theta}-\left(2-\frac{d}{f}\right)e^{i\theta}+1=0,
    \end{align}
    解得
    \begin{align}
        e^{i\theta}=\left(1-\frac{d}{f}\right)\pm i\sqrt{\frac{d}{f}-\frac{d^2}{4f^2}},
    \end{align}
    于是得到
    \begin{align}
        r_n=r_{\text{最大}}\sin\theta(n\theta+\delta),
    \end{align}
    其中
    \begin{align}
        \cos\theta=\re\left[e^{i\theta}\right]=\left(1-\frac{d}{2f}\right),
    \end{align}
    此即式 (6.2-2),
    \begin{align}
        r_{\text{最大}}=\frac{r_0}{\sin\delta}.
    \end{align}
    利用 \eqref{6.1-1} 得
    \begin{gather}
        r_{\text{最大}}\sin(\theta+\delta)=r_0+dr_0',\\
        \Longrightarrow \frac{r_0}{\sin\delta}(\sin\theta\cos\delta+\cos\theta\sin\delta)=r_0+dr_0',\\
        \Longrightarrow\tan\delta=\frac{\sin\delta}{\cos\delta}=\frac{r_0\sin\theta}{(r_0+dr_0')-r_0\cos\theta}=\frac{\sqrt{\frac{4f}{d}-1}}{1+2f\frac{r_0'}{r_0}},
    \end{gather}
    此即式 (6.2-4), 从而
    \begin{align}
        (r_{\text{最大}})^2=\frac{r_0^2}{\sin^2\delta}=\frac{r_0^2(1+\tan^2\delta)}{\tan^2\delta}=\frac{4f}{4f-d}(r_0^2+dr_0r_0'+dfr_0'^2),
    \end{align}
    此即式 (6.2-3).
    光线稳定的条件为
    \begin{gather}
        \frac{d}{f}-\frac{d^2}{4f^2}\geq 0,\\
        \Longrightarrow 0\leq d\leq 4f,
    \end{gather}
    此即式 (6.2-1).
\end{pf}

\begin{exe}
    证明方程
    \[
        \begin{bmatrix}
            A&B\\
            C&D
        \end{bmatrix}\begin{bmatrix}
            r_s\\
            r_s'
        \end{bmatrix}=\lambda\begin{bmatrix}
            r_s\\
            r_s'
        \end{bmatrix}
    \]
    的本征值是 $\lambda=e^{\pm i\theta}$, 其中 $\exp(\pm i\theta)$ 由式 (6.1-13) 给出. 注意, 按照式 (6.1-5), 上述矩阵方程也可以写为
    \begin{align}
        \begin{bmatrix}
            r_{s+1}\\
            r_{s+1}'
        \end{bmatrix}=\lambda\begin{bmatrix}
            r_s\\
            r_s'
        \end{bmatrix}.
    \end{align}
\end{exe}
\begin{pf}
    上述矩阵的特征方程为
    \begin{align}
        \det\left(\begin{vmatrix}
            A&B\\
            C&D
        \end{vmatrix}-\lambda I\right)=\begin{vmatrix}
            A-\lambda&B\\
            C&D-\lambda
        \end{vmatrix}=\lambda^2-(A+D)\lambda+(AD-BC)=\lambda^2-2\lambda+1=0,
    \end{align}
    从而解得特征值为
    \begin{align}
        \lambda=e^{\pm i\theta},
    \end{align}
    其中 $\exp(\pm i\theta)$ 由式 (6.1-13) 给出:
    \begin{align}
        e^{\pm i\theta}=b\pm\sqrt{1-b^2}.
    \end{align}
\end{pf}

\begin{exe}
    对于一个平面波入射到透镜上的情况证明式 (6.4-1) 成立, 由此合理地论证式 (6.4-1) 是正确的.
\end{exe}
\begin{pf}
    设透镜的折射率为 $n$, $(x,y)$ 处厚度为 $t(\sqrt{x^2+y^2})$. 当平面波入射到透镜上, 沿光轴入射透镜和平行光轴于 $(x,y)$ 入射透镜的光线汇聚于焦点, 根据费马原理, 两者自入射到汇聚走过的光程相等:
    \begin{align}
        nt(0)+f=nt(\sqrt{x^2+y^2})+(t(\sqrt{x^2+y^2})-t(0))+\sqrt{f^2+x^2+y^2}.
    \end{align}
    傍轴近似下, 有
    \begin{gather}
        nt(0)+f\approx nt(\sqrt{x^2+y^2})+[t(\sqrt{x^2+y^2})-t(0)]+f\left(1+\frac{x^2+y^2}{2f^2}\right),\\
        \Longrightarrow nt(\sqrt{x^2+y^2})+[t(\sqrt{x^2+y^2})-t(0)]=nt(0)-\frac{x^2+y^2}{2f}.
    \end{gather}
    透镜对平面波的作用是引起相移
    \begin{align}
        \phi(\sqrt{x^2+y^2})=k\{nt(\sqrt{x^2+y^2})+[t(\sqrt{x^2+y^2})-t(0)]\}=knt(0)-k\frac{x^2+y^2}{2f},
    \end{align}
    而不影响振幅, 因此 (忽略整体相因子) 有
    \begin{align}
        E_R(x,y)=E_L(x,y)\exp\left(-ik\frac{x^2+y^2}{2f}\right),
    \end{align}
    此即式 (6.4-1).
\end{pf}

\begin{exe}
    推导方程式 (6.4-7).
\end{exe}
\begin{pf}
    $l$ 处的光线可表为
    \begin{align}
        r(l^-)=&r_0\cos\left(\sqrt{\frac{k_2}{k}}l\right),\\
        r'(l^-)=&-\sqrt{\frac{k_2}{k}}r_0\sin\left(\sqrt{\frac{k_2}{k}}l\right).
    \end{align}
    边界处出射可表为
    \begin{align}
        r(l^+)=&r(l^-)=r_0\cos\left(\sqrt{\frac{k_2}{k}}l\right),\\
        r'(l^+)=&n_0r'(l^-)=-n_0\sqrt{\frac{k_2}{k}}r_0\sin\left(\sqrt{\frac{k_2}{k}}l\right).
    \end{align}
    公共焦点与出射面之间的距离为
    \begin{gather}
        h=\abs{\frac{r_{\text{out}}}{r'_{\text{out}}}}=\frac{1}{n_0}\sqrt{\frac{k_2}{k}}\cot\left(\sqrt{\frac{k_2}{k}}l\right).
    \end{gather}
\end{pf}

\begin{exe}
    证明占据 $0\leq z\leq l$ 区域的类透镜介质把位于 $z<0$ 的轴上点成像为单点. (若成像点位于 $z<l$ 处, 则是虚像.)
\end{exe}
\begin{pf}
    设轴上物点坐标为 $-z_0<0$, 则由该点发出的某条光线可表为 $(0,r_0')$, 经 $-z_0<z<0$ 区域的直线传播后在入射面的入射光线可表为
    \begin{align}
        \begin{bmatrix}
            r(0^-)\\
            r'(0^-)
        \end{bmatrix}=\begin{bmatrix}
            1&z_0\\
            0&1
        \end{bmatrix}\begin{bmatrix}
            0\\
            r_0'
        \end{bmatrix}=\begin{bmatrix}
            z_0r'\\
            r_0'
        \end{bmatrix}.
    \end{align}
    经入射面折射后, 光线可表为
    \begin{align}
        \begin{bmatrix}
            r(0^+)\\
            r'(0^+)
        \end{bmatrix}=\begin{bmatrix}
            1&0\\
            0&\frac{1}{n_0}
        \end{bmatrix}\begin{bmatrix}
            r(0^-)\\
            r'(0^-)
        \end{bmatrix}=\begin{bmatrix}
            z_0r'\\
            \frac{r_0'}{n_0}
        \end{bmatrix}.
    \end{align}
    经类透镜介质中传播后, 在出射面处出射前的光线可表为
    \begin{align}
        \begin{bmatrix}
            r(l^-)\\
            r'(l^-)
        \end{bmatrix}=\begin{bmatrix}
            \cos\left(\sqrt{\frac{k_2}{k}}l\right)&\sqrt{\frac{k}{k_2}}\sin\left(\sqrt{\frac{k_2}{k}}l\right)\\
            -\sqrt{\frac{k_2}{k}}\sin\left(\sqrt{\frac{k_2}{k}}l\right)&\cos\left(\sqrt{\frac{k_2}{k}}l\right)
        \end{bmatrix}\begin{bmatrix}
            r(0^+)\\
            r'(0^+)
        \end{bmatrix}=\begin{bmatrix}
            z_0r_0'\cos\left(\sqrt{\frac{k_2}{k}}l\right)+\sqrt{\frac{k}{k_2}}\frac{r_0'}{n_0}\sin\left(\sqrt{\frac{k_2}{k}}l\right)\\
            -\sqrt{\frac{k_2}{k}}z_0r_0'\sin\left(\sqrt{\frac{k_2}{k}}l\right)+\frac{r_0'}{n_0}\cos\left(\sqrt{\frac{k_2}{k}}l\right)
        \end{bmatrix}.
    \end{align}
    经出射面折射后, 光线可表为
    \begin{align}
        \begin{bmatrix}
            r(l^+)\\
            r'(l^+)
        \end{bmatrix}=\begin{bmatrix}
            1&0\\
            0&n_0
        \end{bmatrix}\begin{bmatrix}
            r(l^-)\\
            r'(l^-)
        \end{bmatrix}=\begin{bmatrix}
            z_0r_0'\cos\left(\sqrt{\frac{k_2}{k}}l\right)+\sqrt{\frac{k}{k_2}}\frac{r_0'}{n_0}\sin\left(\sqrt{\frac{k_2}{k}}l\right)\\
            -\sqrt{\frac{k_2}{k}}n_0z_0r_0'\sin\left(\sqrt{\frac{k_2}{k}}l\right)+r_0'\cos\left(\sqrt{\frac{k_2}{k}}l\right)
        \end{bmatrix}.
    \end{align}
    在 $z=l+d$ 处,
    \begin{align}
        r(l+d)=r(l^+)+dr'(l^+)=z_0r_0'\cos\left(\sqrt{\frac{k_2}{k}}l\right)+\sqrt{\frac{k}{k_2}}\frac{r_0'}{n_0}\sin\left(\sqrt{\frac{k_2}{k}}l\right)+\left[-\sqrt{\frac{k_2}{k}}n_0z_0r_0'\sin\left(\sqrt{\frac{k_2}{k}}l\right)+r_0'\cos\left(\sqrt{\frac{k_2}{k}}l\right)\right]d=0,
    \end{align}
    其中
    \begin{align}
        d=\frac{n_0z_0\cos\left(\sqrt{\frac{k_2}{k}}l\right)+\sqrt{\frac{k}{k_2}}\sin\left(\sqrt{\frac{k_2}{k}}l\right)}{\sqrt{\frac{k_2}{k}}n_0^2z_0\sin\left(\sqrt{\frac{k_2}{k}}l\right)-n_0\cos\left(\sqrt{\frac{k_2}{k}}l\right)},
    \end{align}
    注意到 $r(l+d)=0$ 不依赖于 $r_0'$, 故类透镜介质把轴上物点成像为单点.
\end{pf}

\begin{exe}
    推导表 6.1 列出的光线矩阵.
\end{exe}
\begin{pf}
    \begin{itemize}
        \item[(1)] \textbf{长度为 $d$ 的直线段}: 光线 $(r_i,r_i')$ 在均匀介质中传播 $d$, 则其与光轴的距离变为
        \begin{align}
            r_o=r_i+dr_i',
        \end{align}
        斜率不变
        \begin{align}
            r_o'=r_i',
        \end{align}
        故
        \begin{align}
            \begin{bmatrix}
                r_o\\
                r_o'
            \end{bmatrix}=\begin{bmatrix}
                1&d\\
                0&1
            \end{bmatrix}\begin{bmatrix}
                r_i\\
                r_i'
            \end{bmatrix}.
        \end{align}
        \item[(2)] \textbf{薄透镜 (焦距 $f$)}: 光线 $(r_i,r_i')$ 经过薄透镜, 则其与光轴的距离不变
        \begin{align}
            r_o=r_i,
        \end{align}
        傍轴近似下, 斜率 $r_o'$ 满足
        \begin{gather}
            r_i'-r_o'=\frac{r_o}{f},\\
            \Longrightarrow r_o='=-\frac{r_o}{f}+r_i',
        \end{gather}
        故
        \begin{align}
            \begin{bmatrix}
                r_o\\
                r_o'
            \end{bmatrix}=\begin{bmatrix}
                1&0\\
                -\frac{1}{f}&0
            \end{bmatrix}\begin{bmatrix}
                r_i\\
                r_i'
            \end{bmatrix}.
        \end{align}
        \item[(3)] \textbf{电介质界面 (折射率 $n_1$, $n_2$)}: 光线 $(r_i,r_i')$ 经过电介质界面折射, 则其与光轴的距离不变
        \begin{align}
            r_o=r_i,
        \end{align}
        傍轴近似下, 斜率变为
        \begin{align}
            r_o'=\frac{n_1}{n_2}r_i',
        \end{align}
        故
        \begin{align}
            \begin{bmatrix}
                r_o\\
                r_o'
            \end{bmatrix}=\begin{bmatrix}
                1&0\\
                0&\frac{n_1}{n_2}
            \end{bmatrix}\begin{bmatrix}
                r_i\\
                r_i'
            \end{bmatrix}.
        \end{align}
        \item[(4)] \textbf{球面电介质界面 (半径 $R$)}: 光线 $(r_i,r_i')$ 经过球面电介质界面折射, 则其与光轴的距离不变
        \begin{align}
            r_o=r_i,
        \end{align}
        傍轴近似下, 斜率 $r_o'$ 满足
        \begin{gather}
            n_1\left(\frac{r_i}{R}-r_i'\right)=n_2\left(\frac{r_i}{R}-r_o'\right),\\
            \Longrightarrow r_o'=\frac{n_2-n_1}{n_2}\frac{r_i}{R}+\frac{n_1}{n_2}r_i',
        \end{gather}
        故
        \begin{align}
            \begin{bmatrix}
                r_o\\
                r_o'
            \end{bmatrix}=\begin{bmatrix}
                1&0\\
                \frac{n_2-n_1}{n_2}\frac{1}{R}&\frac{n_1}{n_2}
            \end{bmatrix}\begin{bmatrix}
                r_i\\
                r_i'
            \end{bmatrix}.
        \end{align}
        \item[(5)] \textbf{球面反射镜 (曲率半径 $R$)}: 光线 $(r_i,r_i')$ 经过球面反射镜反射, 则其与光轴的距离不变
        \begin{align}
            r_o=r_i,
        \end{align}
        傍轴近似下, 斜率 $r_o'$ 满足
        \begin{gather}
            \frac{r_i}{R}-r_i'=-r_o'-\frac{r_i'}{R},\\
            \Longrightarrow r_o'=-\frac{2}{R}r_i+r_i',
        \end{gather}
        故
        \begin{align}
            \begin{bmatrix}
                r_o\\
                r_o'
            \end{bmatrix}=\begin{bmatrix}
                1&0\\
                -\frac{2}{R}&1
            \end{bmatrix}\begin{bmatrix}
                r_i\\
                r_i'
            \end{bmatrix}.
        \end{align}
        \item[(6)] \textbf{有二次型折射率变化曲线的介质}: 介质的折射率分布为
        \begin{align}
            \label{6.6-n-dist}
            n(x,y)=n_0\left[1-\frac{k_2}{2k}(x^2+y^2)\right],
        \end{align}
        其中 $k_2$ 为常数. 光线在非均匀介质中传播的微分方程为
        \begin{align}
            \frac{\mathrm{d}}{\mathrm{d}s}\left(n\frac{\mathrm{d}\bm{r}}{\mathrm{d}s}\right)=\nabla,
        \end{align}
        其中 $s$ 为沿光线的切向距离, $\bm{r}$ 为光线的位矢. 傍轴近似下, 可用 $\frac{\mathrm{d}}{\mathrm{d}z}$ 代替 $\frac{\mathrm{d}}{\mathrm{d}s}$, 并将式 \eqref{6.6-n-dist} 代入可得
        \begin{align}
            \frac{\mathrm{d}^2r}{\mathrm{d}z^2}+\left(\frac{k_2}{k}\right)r=0,
        \end{align}
        对入射光线 $\begin{bmatrix}
            r(0)\\
            r'(0)
        \end{bmatrix}=\begin{bmatrix}
            r_i\\
            r_i'
        \end{bmatrix}$, 解得
        \begin{align}
            r(z)=&r_i\cos\left(\sqrt{\frac{k_2}{k}}z\right)+\sqrt{\frac{k}{k_2}}r_i'\sin\left(\sqrt{\frac{k_2}{k}}z\right),\\
            r'(z)=&-\sqrt{\frac{k_2}{k}}r_i\sin\left(\sqrt{\frac{k_2}{k}}z\right)+r_i'\cos\left(\sqrt{\frac{k_2}{k}}z\right),
        \end{align}
        故
        \begin{align}
            \begin{matrix}
                r(l)\\
                r'(l)
            \end{matrix}=\begin{bmatrix}
                \cos\left(\sqrt{\frac{k_2}{k}}l\right)&\sqrt{\frac{k}{k_2}}\sin\left(\sqrt{\frac{k_2}{k}}l\right)\\
                -\sqrt{\frac{k_2}{k}}\sin\left(\sqrt{\frac{k_2}{k}}l\right)&\cos\left(\sqrt{\frac{k_2}{k}}l\right)
            \end{bmatrix}\begin{bmatrix}
                r_i\\
                r_i'
            \end{bmatrix}.
        \end{align}
    \end{itemize}
\end{pf}

\begin{exe}
    若透镜相对于入射光束置于任意位置处 (即不置于腰部), 对于这种情况求解导出式 (6.7-11) 和 (6.7-12) 的问题.
\end{exe}
\begin{pf}
    设入射高斯光束的束腰半径为 $\omega_{01}$, 透镜位于距入射光束束腰 $z_1$ 处, 则透镜前表面处光斑半径的平方 $\omega_1^2=[\omega_1(z_1)]^2=\omega_{01}^2\left[1+\left(\frac{z_1}{z_{01}}\right)^2\right]$, 等相位面曲率半径 $R_1=R_1(z_1)=z_1\left[1+\left(\frac{z_{01}}{z_1}\right)^2\right]$, 其中 $z_{01}=\frac{\pi\omega_{01}^2n}{\lambda}$, 因而
    \begin{align}
        \frac{1}{q_1}=\frac{1}{R_1}-i\frac{\lambda}{\pi n\omega_1^2}=\frac{1}{z_1+iz_{01}}.
    \end{align}
    光束经过透镜折射, 在透镜后表面的参量为
    \begin{gather}
        \frac{1}{q_2}=\frac{1}{q_1}-\frac{1}{f},\\
        \Longrightarrow q_2=\frac{f(z_1+z_{01})}{f-(z_1+iz_{01})}.
    \end{gather}
    光束经过距离 $l$ 的传播, 在平面 (3) 处的参量为
    \begin{gather}
        q_3=q_2+l=\frac{(f-l)(z_1+iz_{01})+fl}{f-(z_1+iz_{01})},\\
        \Longrightarrow\frac{1}{q_3}=\frac{1}{R_3}-i\frac{\lambda}{\pi\omega_3^2n}=\frac{\{(f-z_1)[(f-l)z_1+fl]-z_{01}^2(f-l)\}-if^2z_{01}}{[(f-l)z_1+fl]^2+[(f-l)z_{01}]^2}.
    \end{gather}
    在新束腰处 $R_3=\infty$, 由此得新束腰位置为
    \begin{align}
        l=\frac{f}{1+\frac{f(f-z_1)}{z_{01}^2-(f-z_1)z_1}},
    \end{align}
    且新束腰半径与原束腰半径之比为
    \begin{align}
        \frac{\omega_3}{\omega_{01}}=\frac{\frac{f}{z_{01}}}{\sqrt{1+\left(\frac{f-z_1}{z_{01}}\right)^2}}.
    \end{align}
\end{pf}

\begin{exe}
    \begin{itemize}
        \item[(a)] 若高斯光束垂直入射到折射率为 $n$ 的固体棱镜上, 如下图所示.
        试求出射光束的远场衍射角.
        \item[(b)] 若棱镜向左移动一直到它的入射面位于 $s=-l_1$ 处. 试求出新的出射光束的腰部大小及腰部位置. (假设晶体足够长, 以致光束的腰部位于晶体内.)
    \end{itemize}
\end{exe}
\begin{sol}
    \begin{itemize}
        \item[(a)] $z=l_1$ 处入射固体棱镜前, 高斯光束光斑半径的平方为 $[\omega(l_1^-)]^2=\omega_0^2\left[1+\left(\frac{l_1}{z_0}\right)^2\right]$, 等相位面曲率半径为 $R(l_1^-)=z_1\left[1+\left(\frac{z_0}{l_1}\right)^2\right]$, 其中 $z_0=\frac{\pi\omega_0^2n}{\lambda}$, 因而
        \begin{gather}
            \frac{1}{q(l_1^-)}=\frac{1}{R(l_1^-)}-i\frac{\lambda}{\pi n[\omega(l_1^-)]^2}=\frac{1}{l_1+iz_0},\\
            \Longrightarrow q(l_1^-)=l_1+iz_0.
        \end{gather}
        $z=l_1$ 处, 光束入射后的参量为
        \begin{align}
            q(l_1^+)=\frac{q(l_1^-)}{\frac{1}{n}}=n(l_1+iz_0).
        \end{align}
        $z=l_2$ 出射前光束的参量为
        \begin{align}
            q(l_2^-)=q(l_1^+)+(l_2-l_1)=n(l_1+iz_0)+(l_2-l_1).
        \end{align}
        $z=l_2$ 光束出射后的参量为
        \begin{align}
            q(l_2^+)=\frac{q(l_2^-)}{n}=(l_1+iz_0)+\frac{l_2-l_1}{n}.
        \end{align}
        $z=l_3$ 处光束的参量为
        \begin{align}
            q(l_3)=q(l_2^+)+l=(l_1+iz_0)+\frac{l_2-l_1}{n}+(l_3-l_2).
        \end{align}
        由
        \begin{align}
            \frac{1}{q(l_3)}=\frac{1}{R(l_3)}-i\frac{\lambda}{\pi n[\omega(l_3)]^2},
        \end{align}
        得光束等相位面曲率半径
        \begin{align}
            \frac{1}{R_3}=\frac{l_1+\frac{l_2-l_1}{n}+(l_3-l_2)}{\left[l_1+\frac{l_2-l_1}{n}+(l_3-l_2)\right]^2+z_0^2},
        \end{align}
        及束腰半径
        \begin{align}
            \omega(l_3)=\omega_0\sqrt{1+\left[\frac{l_1+\frac{l_2-l_1}{n}+(l_3-l_2)}{z_0}\right]^2}
        \end{align}
        在新束腰处 $R(l_3)=\infty$, 由此得
        \begin{align}
            l_3=l_2-\left(l_1+\frac{l_2-l_1}{n}\right),
        \end{align}
        及新束腰半径
        \begin{align}
            \omega_0'=\omega_0.
        \end{align}
        此时出射光束的远场衍射角为
        \begin{align}
            \theta\approx\frac{\lambda}{\pi\omega_0'n}=\frac{\lambda}{\pi\omega_0n}.
        \end{align}
        \item[(b)] 当棱镜入射面位于 $z=-l_1$ 处, 则新的出射光束的腰部半径为
        \begin{align}
            \omega_0'=\omega_0,
        \end{align}
        位置为
        \begin{align}
            l_3=(l_1+l_2)-\frac{l_1+l_2}{n}.
        \end{align}
    \end{itemize}
\end{sol}

\begin{exe}
    波长为 $\lambda$ 的高斯光束入射到置于 $Z=l$ 的透镜上, 如下图所示.
    要使出射光束的腰位于晶体样品的前表面上, 试计算透镜的焦距 $f$. 证明 (对给定的 $l$ 和 $L$) 可能存在两个解. 对每个解画出光束的传播情况.
\end{exe}
\begin{pf}
    利用习题 6.7  的结论, 新束腰距离透镜
    \begin{gather}
        \frac{f}{1+\frac{f(f-l)}{z_0^2-(f-l)l}}=L,\\
        \Longrightarrow(l+L)f^2-(l^2+2lL+z_0^2)f+(l^2+z_0^2)L=0,
    \end{gather}
    解得当 $(l^2+z_0^2)^2-4L^2z_0^2\geq 0$ 时,
    \begin{align}
        f=\frac{l^2+2lL+z_0^2\pm\sqrt{(l^2+z_0^2)^2-4L^2z_0^2}}{l+L}.
    \end{align}
\end{pf}

\begin{exe}
    补全 6.12 节推导过程中所有略去的步骤.
\end{exe}
\begin{pf}
    仿照 6.5 节, 取 $E=\psi(x,y,z)e^{-ikz}$, 将亥姆霍兹方程化为
    \begin{align}
        \label{6.10-1}
        \nabla_t^2\psi-2ik\psi'-k(k_{2x}x^2+k_{2y}y^2)\psi=0,
    \end{align}
    其中 $\psi'=\frac{\partial\psi}{\partial z}$.
    假设波动方程的一个解为
    \begin{align}
        \psi=\exp\left\{-i\left[P(z)+\frac{Q(z)x^2}{2}+\frac{Q_y(z)y^2}{2}\right]\right\},
    \end{align}
    将其代入式 \eqref{6.10-1} 得
    \begin{align}
        Q_x^2x^2+Q_yy^2+iQ_x+iQ_y+2kP'+k(Q_x'x+Q_y'y)+kk_2(x^2+y^2)=0.
    \end{align}
    上式对任一 $x,y$ 均成立, 故 $x,y$ 的各次幂的系数均等于零, 从而导出
    \begin{align}
        \label{6.10-2}
        Q_x^2+k\frac{\mathrm{d}Q_x}{\mathrm{d}z}+kk_{2x}=0,\quad Q_y^2+k\frac{\mathrm{d}Q_y}{\mathrm{d}z}+kk_{2y}=0
    \end{align}
    和
    \begin{align}
        \label{6.10-5}
        \frac{\mathrm{d}P}{\mathrm{d}z}=-i\left(\frac{Q_x+Q_y}{2k}\right).
    \end{align}
    假设介质均匀, 则 $k_{2x}=k_{2y}=0$, 式 \eqref{6.10-2} 可化为
    \begin{align}
        \label{6.10-3}
        Q_x^2+k\frac{\mathrm{d}Q_x}{\mathrm{d}z}=0,\quad Q_y^2+k\frac{\mathrm{d}Q_y}{\mathrm{d}z}=0.
    \end{align}
    引入函数 $s_x(z)$ 和 $s_y(z)$, 满足
    \begin{align}
        Q_x=k\frac{s_x'}{s_x},\quad Q_y=k\frac{s_y'}{s_y}.
    \end{align}
    由式 \eqref{6.10-3} 可得
    \begin{align}
        s_x''=0,\quad s_y''=0,
    \end{align}
    因而
    \begin{align}
        s_x=a_xz+b_x,\quad s_y=a_yz+b_y,
    \end{align}
    或
    \begin{align}
        \label{6.10-4}
        Q_x(z)=k\frac{a_x}{a_xz+b_z},\quad Q_y(z)=k\frac{a_y}{a_yz+b_y},
    \end{align}
    其中 $a_x,b_x,a_y,b_y$ 为任意常数.
    定义
    \begin{align}
        q_x(z)=\frac{k}{Q_x(z)},\quad q_y(z)=\frac{k}{Q_y(z)},
    \end{align}
    从而将式 \eqref{6.10-4} 改写为
    \begin{align}
        q_x=z+C_x,\quad q_y=z+C_y,
    \end{align}
    其中 $C_x$ 和 $C_y$ 为任意积分常数.
    将 $C_x$ 和 $C_y$ 写成如下形式:
    \begin{align}
        C_x=-z_x+q_{0x},\quad C_y=-z_y+q_{0y},
    \end{align}
    其中 $z_x$ 和 $z_y$ 为实数, $q_{0x}$ 和 $q_{0y}$ 为虚数.
    将 $q_x(z)$ 和 $q_y(z)$ 代入式 \eqref{6.10-5} 可得
    \begin{align}
        P'=-\frac{i}{2}\left[\frac{1}{z+C_x}+\frac{1}{z+C_y}\right],
    \end{align}
    取积分常数为零得
    \begin{align}
        P=-\frac{i}{2}\left[\ln\left(1+\frac{z-z_x}{q_{0x}}\right)+\ln\left(1+\frac{z-z_y}{q_{0y}}\right)\right].
    \end{align}
    将上式代入 $\psi$ 的假设解中得
    \begin{align}
        \label{6.10-6}
        \psi=\exp\left\{-i\left[-\frac{i}{2}\ln\left(1+\frac{z-z_x}{q_0}\right)-\frac{i}{2}\ln\left(1+\frac{z-z_y}{q_{0y}}\right)+\frac{kx^2}{2(q_{0x}+z-z_x)}+\frac{ky^2}{2(q_{0y}+z-z_y)}\right]\right\}.
    \end{align}
    取
    \begin{gather}
        q_{0x}=i\frac{\pi\omega_{ox}^2n}{\lambda},\quad q_{0y}=i\frac{\pi\omega_{0y}^2n}{\lambda},
    \end{gather}
    则式 \eqref{6.10-6} 中的
    \begin{align}
        \notag&\exp\left[-\frac{1}{2}\ln\left(1+\frac{z-z_x}{q_{0x}}\right)-\frac{1}{2}\ln\left(1+\frac{z-z_y}{q_{0y}}\right)\right]=\frac{1}{\left[1+\frac{z-z_x}{q_{0x}}\right]^{1/2}\left[1+\frac{z-z_y}{q_{0y}}\right]^{1/2}}\\
        \notag=&\frac{1}{\left[\sqrt{1+\abs{\frac{z-z_x}{q_{0x}}}^2}\exp\left(i\arctan\frac{z-z_x}{iq_{0y}}\right)\right]^{1/2}\left[\sqrt{1+\abs{\frac{z-z_y}{q_{0y}}}^2}\exp\left(i\arctan\frac{z-z_y}{iq_{0y}}\right)\right]^{1/2}}\\
        =&\frac{\sqrt{\omega_{0x}\omega_{0y}}}{\sqrt{\omega_x(z)\omega_y(z)}}\exp[i\eta(z)],
    \end{align}
    其中
    \begin{gather}
        \omega_x^2(z)=\omega_{0x}^2\left[1+\left(\frac{\lambda(z-z_x)}{\pi\omega_{0x}^2n}\right)^2\right],\quad\omega_y^2(z)=\omega_{0y}^2\left[1+\left(\frac{\lambda(z-z_y)}{\pi\omega_{0y}^2n}\right)^2\right],\\
        \eta=\frac{1}{2}\tan^{-1}\left(\frac{\lambda(z-z_x)}{\pi\omega_{0x}^2n}\right)+\frac{1}{2}\tan^{-1}\left(\frac{\lambda(z-z_y)}{\pi\omega_{0y}^2n}\right).
    \end{gather}
    式 \eqref{6.10-6} 中的
    \begin{align}
        \notag&\exp\left[\frac{-ikx^2}{2(q_{0x}+z-z_x)}+\frac{-iky^2}{2(q_0+z-z_y)}\right]=\exp\left\{\frac{-i\frac{k}{q_{0x}}x^2}{2\left(1+\frac{z-z_{0x}}{q_{0x}}\right)}+\frac{-i\frac{k}{q_{0y}}y^2}{2\left(1+\frac{z-z_{0y}}{q_{0y}}\right)}\right\}\\
        \notag=&\exp\left\{-x^2\frac{1}{\omega_{0x}^2\left(1+\frac{z-z_x}{q_{0x}}\right)}-y^2\frac{1}{\omega_{0y}^2\left(1+\frac{z-z_y}{q_{0y}}\right)}\right\}\\
        \notag=&\exp\left\{-x^2\frac{1-\frac{z-z_x}{q_{0x}}}{\omega_{0x}^2\left(1+\abs{\frac{z-z_x}{q_{0x}}}^2\right)}-y^2\frac{1-\frac{z-z_y}{q_{0y}}}{\omega_{0y}^2\left(1+\abs{\frac{z-z_y}{q_{0y}}}^2\right)}\right\}\\
        =&\exp\left\{-x^2\left(\frac{1}{\omega_x^2(x)}+\frac{ik}{2R_x(z)}\right)-y^2\left(\frac{1}{\omega_y^2(z)}+\frac{ik}{2R_y(z)}\right)\right\},
    \end{align}
    其中
    \begin{align}
        R_x(z)=(z-z_x)\left[1+\left(\frac{\pi\omega_{0x}^2n}{\lambda(z-z_x)}\right)^2\right],\quad R_y(z)=(z-z_y)\left[1+\left(\frac{\pi\omega_{0y}^2n}{\lambda(z-z_y)}\right)\right].
    \end{align}
    综上, 在均匀介质中,
    \begin{align}
        \notag E(x,y,z)=&E_0\frac{\sqrt{\omega_{0x}\omega_{0y}}}{\sqrt{\omega_x(z)\omega_y(z)}}\exp\left\{-i[kz-\eta(z)]-\frac{ikx^2}{2q_x(z)}-\frac{iky^2}{2q_y(z)}\right\}\\
        =&E_0\frac{\sqrt{\omega_{0x}\omega_{0y}}}{\sqrt{\omega_x(z)\omega_y(z)}}\exp\left\{-i[kz-\eta(z)]-x^2\left(\frac{1}{\omega_x^2(z)}+\frac{ik}{2R_x(z)}\right)-y^2\left(\frac{1}{\omega_y^2(z)}+\frac{ik}{2R_y(z)}\right)\right\}.
    \end{align}
    对比 $\psi$ 的假设解和上式可得
    \begin{align}
        \frac{1}{q_x(z)}=&\frac{1}{R_x(z)}-i\frac{\lambda}{\pi n\omega_x^2(z)},\\
        \frac{1}{q_y(z)}=&\frac{1}{R_y(z)}-i\frac{\lambda}{\pi n\omega_y^2(z)}.
    \end{align}

    在折射率分布为
    \begin{align}
        n^2(\bm{r})=n^2\left(1-\frac{n_{2x}}{n}x^2-\frac{n_{2y}}{n}y^2\right)
    \end{align}
    的二次型类透镜介质中, 亥姆霍兹方程可化为
    \begin{align}
        \nabla^2\bm{E}+k^2\left(1-\frac{n_{2x}}{n}x^2-\frac{n_{2y}}{n}y^2\right).
    \end{align}
    假设标量场的形式为 $E(\bm{r})=\psi(\bm{r})\exp(-i\beta z)$, 则上述方程可化为
    \begin{align}
        \frac{\partial^2\psi}{\partial x^2}+\frac{\partial^2\psi}{\partial y^2}+\left[k^2\left(1-\frac{n_{2x}}{n}x^2-\frac{n_{2y}}{n}y^2\right)-\beta^2\right]\psi=0.
    \end{align}
    取 $\psi=f(x)g(y)$, 并将上式除以 $\psi$ 得
    \begin{align}
        \frac{1}{f}\frac{\mathrm{d}^2f}{\mathrm{d}x^2}+\left(\lambda_1-k^2\frac{n_{2x}}{n}x^2\right)=-\frac{1}{g}\frac{\mathrm{d}^2g}{\mathrm{d}y^2}+\left[(k^2-\beta^2-\lambda_1)-k^2\frac{n_2}{n}y^2\right],
    \end{align}
    分离变量得两个微分方程:
    \begin{align}
        \frac{\mathrm{d}^2f}{\mathrm{d}x^2}+\left(\lambda_1-k^2\frac{n_2}{n}x^2\right)f=&0,\\
        \frac{\mathrm{d}^2g}{\mathrm{d}y^2}+\left[(k-\beta^2-\lambda_1)-k^2\frac{n_2}{n}y^2\right]g=0.
    \end{align}
    做变量代换
    \begin{align}
        \xi=\frac{\sqrt{2}x}{\omega_x},\quad\omega_x=\left(\frac{\lambda_1}{\pi}\right)^{1/2}\left(\frac{1}{nn_{2x}}\right)^{1/4},
    \end{align}
    从而将上面的微分方程化为
    \begin{align}
        \frac{\mathrm{d}^2f}{\mathrm{d}\xi^2}+\left(\frac{\omega_x^2\lambda_1}{2}-\xi^2\right)f=0.
    \end{align}
    假设上述方程的解具有如下形式:
    \begin{align}
        f\left(\frac{\omega_x\xi}{\sqrt{2}}\right)=H(\xi)e^{-\xi^2/2},
    \end{align}
    其中 $H(\xi)$ 是一个有限级数的多项式. 将该假设解代入微分方程得
    \begin{align}
        \frac{\mathrm{d}^2H}{\mathrm{d}\xi^2}-2\xi\frac{\mathrm{d}H}{\mathrm{d}\xi}+\left(\frac{\omega_x^2\lambda_1}{2}-1\right)H=0,
    \end{align}
    从而解得 $H(\xi)$ 为厄米多项式 $H_l(\xi)$, 且
    \begin{align}
        \frac{\omega_x^2\lambda_1}{2}=2l+1.
    \end{align}
    对关于 $y$ 的微分方程也可同理求解, 故
    \begin{align}
        E_{l,m}(\bm{r})=E_0e^{-i\beta_{l,m}z}H_l\left(\sqrt{2}\frac{x}{\omega_x}\right)H_m\left(\sqrt{2}\frac{y}{\omega_y}\right)\exp\left(-\frac{x^2}{\omega_x^2}-\frac{y^2}{\omega_y^2}\right),
    \end{align}
    且
    \begin{gather}
        k^2-\beta^2=\lambda_1^2+(k^2-\beta^2-\lambda_1)=\frac{2}{\omega_x^2}[2(l+1)]+\frac{2}{\omega_y^2}[2(m+1)],\\
        \Longrightarrow\beta_{l,m}=k\left\{1-\frac{2}{k}\left[\sqrt{\frac{n_{2x}}{n}}\left(l+\frac{1}{2}\right)+\sqrt{\frac{n_{2y}}{n}}\left(m+\frac{1}{2}\right)\right]\right\}^{1/2}.
    \end{gather}
\end{pf}

\begin{exe}
    证明式 (6.10-10).\\
    提示: 把光脉冲场看作载波和包络函数的乘积
    \[
        E(z,t)=E_0e^{i(\omega_0t-k_0z)}\int_{-\infty}^{+\infty}G(\Delta\omega)e^{i(\Delta\omega t-\Delta kz)}\,\mathrm{d}(\Delta\omega)
    \]
    式中 $\Delta\omega\equiv\omega-\omega_0$, $\Delta k=k(\omega)-k_0$.
\end{exe}
\begin{pf}
    由傅里叶变换得光场频谱为
    \begin{align}
        G(\Delta\omega)=\frac{1}{2\pi}\int_{-\infty}^{+\infty}\frac{E(z,t)}{E_0}e^{-i[(\omega_0+\Delta\omega)\tau-(k_0+\Delta k)z]}\,\mathrm{d}\tau.
    \end{align}
    对一个持续时间为 $\tau$ 的光脉冲, 该脉冲的谱宽满足
    \begin{gather}
        \Delta\omega\frac{\tau}{2}=\pi,\\
        \Longrightarrow\Delta\omega=\frac{2\pi}{\tau}.
    \end{gather}
    单频光传播距离 $L$ 所用的时间为
    \begin{align}
        t=\frac{L}{v_g}.
    \end{align}
    该脉冲传输距离 $L$ 后, 增宽为
    \begin{align}
        \Delta\tau\approx\abs{\frac{\mathrm{d}\tau}{\mathrm{d}t}}\Delta\omega=\abs{\frac{\mathrm{d}\left(\frac{L}{v_g}\right)}{\mathrm{d}\omega}}\Delta\omega=\frac{L}{v_g^2}\frac{\mathrm{d}v_g}{\mathrm{d}\omega}\frac{2\pi}{\tau}.
    \end{align}
\end{pf}

\begin{exe}
    一根二次型折射率变化的玻璃纤维长 $1000$ 米, $n=1.5$, $n_2=5\times 10^2$ 厘米${}^{-2}$. 波长 $\lambda=1$ 微米的光束在此纤维中传播, 试求在 (a) 单模 $l=m=0$ 激发情况下, (b) $l=m=5$ 情况下此载波的光斑尺寸及最大的脉冲重复频率.
\end{exe}
\begin{sol}
    \begin{itemize}
        \item[(a)] 单模 $l=m=0$ 激发情况下, 光斑半径为
        \begin{align}
            w_0=\left(\frac{\lambda}{\pi}\right)^{1/2}\left(\frac{1}{nn_2}\right)^{1/4}=1.08\times 10^{-5}\,\text{m}=10.8\,\mu\text{m},
        \end{align}
        最大脉冲重复频率为
        \begin{align}
            f_{\max}\approx\frac{1}{\Delta\tau}=\frac{1}{\frac{Lnn_2\Delta\omega}{c^2k^3}\left[1+\frac{n_2/n}{2k^2}(0+0+1)^2\right]^2(0+0+1)^2}=\frac{1.00\times 10^{28}\,\text{Hz}^2}{\Delta\omega},
        \end{align}
        其中 $\Delta\omega$ 为载波的光谱宽度.
        \item[(b)] $l=m=5$ 情况下, 光斑半径为
        \begin{align}
            w_5=\sqrt{2*5+1}w_0=3.58\times 10^{-5}\,\text{m}=35.8\,\mu\text{m},
        \end{align}
        最大脉冲重复频率为
        \begin{align}
            f_{\max}\approx\frac{1}{\Delta\tau}=\frac{1}{\frac{Lnn_2\Delta\omega}{c^2k^3}\left[1+\frac{n_2/n}{2k^2}(5+5+1)^2\right]^2(5+5+1)^2}=\frac{8.30\times 10^{25}\,\text{Hz}^2}{\Delta\omega}.
        \end{align}
    \end{itemize}
\end{sol}

\begin{exe}
    推导式 (6.10-4) 和 (6.10-5).
\end{exe}
\begin{pf}
    二次型折射率变化的介质中矢量波动方程为
    \begin{align}
        \nabla^2\bm{E}+k^2\left(1-\frac{n_2}{n}r^2\right)\bm{E}=0,
    \end{align}
    其中光束在折射率为 $n$ 的均匀介质中的传播常数 $k=\frac{2\pi n}{\lambda}$.
    设标量场的形式为 $E(\bm{r})=\psi(\bm{r})\exp(i\beta z)$, 从而上述方程化为
    \begin{align}
        \frac{\partial^2\psi}{\partial x^2}+\frac{\partial^2\psi}{\partial y^2}+\left[k^2\left(1-\frac{n_2}{n}r^2\right)-\beta^2\right]\psi=0.
    \end{align}
    取 $\psi=f(x)g(y)$, 并将上式除以 $\psi$ 得
    \begin{align}
        \frac{1}{f}\frac{\mathrm{d}^2f}{\mathrm{d}x^2}+\left(\lambda_1-k^2\frac{n_2}{n}x^2\right)=-\frac{1}{g}\frac{\mathrm{d}^2g}{\mathrm{d}y^2}-\left[(k^2-\beta^2-\lambda_1)-k^2\frac{n_2}{n}y^2\right],
    \end{align}
    分离变量得两个微分方程:
    \begin{align}
        \frac{\mathrm{d}^2f}{\mathrm{d}x^2}+\left(\lambda_1-k^2\frac{n_2}{n}x^2\right)f=&0,\\
        \frac{\mathrm{d}^2g}{\mathrm{d}y^2}+\left[(k^2-\beta^2-\lambda_1)-k^2\frac{n_2}{n}y^2\right]g=&0.
    \end{align}
    作变量代换
    \begin{align}
        \xi=\frac{\sqrt{2}x}{\omega},\quad\omega=\left(\frac{\lambda_1}{\pi}\right)^{1/2}\left(\frac{1}{nn_2}\right)^{1/4},
    \end{align}
    从而将上面的微分方程化为
    \begin{align}
        \frac{\mathrm{d}^2f}{\mathrm{d}\xi^2}+\left(\frac{\omega^2\lambda_1}{2}-\xi^2\right)f=0.
    \end{align}
    假设上述方程的解具有如下形式:
    \begin{align}
        f\left(\frac{\omega\xi}{\sqrt{2}}\right)=H(\xi)e^{-\xi^2/2},
    \end{align}
    其中 $H(\xi)$ 是一个有限级数的多项式.
    将该假设解代入微分方程得
    \begin{align}
        \frac{\mathrm{d}^2H}{\mathrm{d}\xi^2}-2\xi\frac{\mathrm{d}H}{\mathrm{d}\xi}+\left(\frac{\omega^2\lambda_1}{2}-1\right)H=0,
    \end{align}
    从而解得 $H(\xi)$ 为厄米多项式 $H_l(\xi)$, 且
    \begin{align}
        \frac{\omega^2\lambda_1}{2}=2l+1.
    \end{align}
    对关于 $y$ 的微分方程也可同理求解, 故
    \begin{align}
        \psi_{l,m}(x,y)=f_l(x)g_m(y)=E_0H_l\left(\sqrt{2}\frac{x}{\omega}\right)H_m\left(\sqrt{2}\frac{y}{\omega}\right)\exp\left(-\frac{x^2+y^2}{\omega^2}\right),
    \end{align}
    且
    \begin{gather}
        k^2-\beta^2=\lambda_1+(k^2-\beta^2-\lambda_1)=\frac{2}{\omega^2}[(2l+1)+(2m+1)],\\
        \Longrightarrow\beta_{l,m}=k\left[1-\frac{2}{k}\sqrt{\frac{n_2}{n}}(l+m+1)\right]^{1/2}.
    \end{gather}
\end{pf}
\ifx\allfiles\undefined
\end{document}
\fi